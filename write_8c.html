<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libinfluxdb: experiment/write.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libinfluxdb
   </div>
   <div id="projectbrief">InfluxDB C API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e3d235265a98282195efca54a39d1899.html">experiment</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">write.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;curl/curl.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div>
<p><a href="write_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7244ab798f58214294b580ca0bb48552" id="r_a7244ab798f58214294b580ca0bb48552"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:a7244ab798f58214294b580ca0bb48552"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9fd3406cc9e17f33dec6c2f39bb2aaed" id="r_a9fd3406cc9e17f33dec6c2f39bb2aaed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url</a> (char *url)</td></tr>
<tr class="separator:a9fd3406cc9e17f33dec6c2f39bb2aaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423a478c44e2b1cb151313dba8750784" id="r_a423a478c44e2b1cb151313dba8750784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a423a478c44e2b1cb151313dba8750784">get_system_data</a> (char *cpu_temp, char *disk_space, char *ipv4)</td></tr>
<tr class="separator:a423a478c44e2b1cb151313dba8750784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80aad395c45035ccaceebbd08ecd100d" id="r_a80aad395c45035ccaceebbd08ecd100d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a80aad395c45035ccaceebbd08ecd100d">build_payload</a> (char *payload)</td></tr>
<tr class="separator:a80aad395c45035ccaceebbd08ecd100d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4" id="r_ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af203df082d5c6dcaa0c88b07cf86466d" id="r_af203df082d5c6dcaa0c88b07cf86466d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a> = &quot;192.168.86.53&quot;</td></tr>
<tr class="separator:af203df082d5c6dcaa0c88b07cf86466d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a04ad582de2b7d36b96f9db429c2c6" id="r_a83a04ad582de2b7d36b96f9db429c2c6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a83a04ad582de2b7d36b96f9db429c2c6">port</a> = 8086</td></tr>
<tr class="separator:a83a04ad582de2b7d36b96f9db429c2c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a48a6504d4d5a43bd3ab452ee0e8cb4" id="r_a8a48a6504d4d5a43bd3ab452ee0e8cb4"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a8a48a6504d4d5a43bd3ab452ee0e8cb4">database</a> = &quot;test_bucket1&quot;</td></tr>
<tr class="separator:a8a48a6504d4d5a43bd3ab452ee0e8cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d71425d9df28667d528833a4db10432" id="r_a1d71425d9df28667d528833a4db10432"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="write_8c.html#a1d71425d9df28667d528833a4db10432">token</a></td></tr>
<tr class="separator:a1d71425d9df28667d528833a4db10432"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7244ab798f58214294b580ca0bb48552" name="a7244ab798f58214294b580ca0bb48552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7244ab798f58214294b580ca0bb48552">&#9670;&#160;</a></span>MAX_BUF_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_BUF_SIZE&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00007">7</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9fd3406cc9e17f33dec6c2f39bb2aaed" name="a9fd3406cc9e17f33dec6c2f39bb2aaed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fd3406cc9e17f33dec6c2f39bb2aaed">&#9670;&#160;</a></span>build_influxdb_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void build_influxdb_url </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00017">17</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>                                   {</div>
<div class="line"><span class="lineno">   18</span>  snprintf(url,</div>
<div class="line"><span class="lineno">   19</span>           <a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>,</div>
<div class="line"><span class="lineno">   20</span>           <span class="stringliteral">&quot;http://%s:%u/api/v2/write?org=akiel&amp;bucket=%s&amp;precision=s&quot;</span>,</div>
<div class="line"><span class="lineno">   21</span>           <a class="code hl_variable" href="write_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>,</div>
<div class="line"><span class="lineno">   22</span>           <a class="code hl_variable" href="write_8c.html#a83a04ad582de2b7d36b96f9db429c2c6">port</a>,</div>
<div class="line"><span class="lineno">   23</span>           <a class="code hl_variable" href="write_8c.html#a8a48a6504d4d5a43bd3ab452ee0e8cb4">database</a>);</div>
<div class="line"><span class="lineno">   24</span>}</div>
<div class="ttc" id="awrite_8c_html_a7244ab798f58214294b580ca0bb48552"><div class="ttname"><a href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a></div><div class="ttdeci">#define MAX_BUF_SIZE</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00007">write.c:7</a></div></div>
<div class="ttc" id="awrite_8c_html_a83a04ad582de2b7d36b96f9db429c2c6"><div class="ttname"><a href="write_8c.html#a83a04ad582de2b7d36b96f9db429c2c6">port</a></div><div class="ttdeci">uint32_t port</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00011">write.c:11</a></div></div>
<div class="ttc" id="awrite_8c_html_a8a48a6504d4d5a43bd3ab452ee0e8cb4"><div class="ttname"><a href="write_8c.html#a8a48a6504d4d5a43bd3ab452ee0e8cb4">database</a></div><div class="ttdeci">char * database</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00012">write.c:12</a></div></div>
<div class="ttc" id="awrite_8c_html_af203df082d5c6dcaa0c88b07cf86466d"><div class="ttname"><a href="write_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a></div><div class="ttdeci">char * hostname</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00010">write.c:10</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="write_8c.html#a8a48a6504d4d5a43bd3ab452ee0e8cb4">database</a>, <a class="el" href="write_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>, <a class="el" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>, and <a class="el" href="write_8c.html#a83a04ad582de2b7d36b96f9db429c2c6">port</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="a80aad395c45035ccaceebbd08ecd100d" name="a80aad395c45035ccaceebbd08ecd100d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80aad395c45035ccaceebbd08ecd100d">&#9670;&#160;</a></span>build_payload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void build_payload </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>payload</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00037">37</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>                                  {</div>
<div class="line"><span class="lineno">   38</span>  <span class="keywordtype">char</span> cpu_temp[<a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>], disk_space[<a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>], ipv4[<a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <span class="comment">// Get system data</span></div>
<div class="line"><span class="lineno">   41</span>  <a class="code hl_function" href="write_8c.html#a423a478c44e2b1cb151313dba8750784">get_system_data</a>(cpu_temp, disk_space, ipv4);</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <span class="comment">// Format the measurements into InfluxDB line protocol format</span></div>
<div class="line"><span class="lineno">   44</span>  snprintf(payload,</div>
<div class="line"><span class="lineno">   45</span>           <a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>,</div>
<div class="line"><span class="lineno">   46</span>           <span class="stringliteral">&quot;cpu_temp,host=server01 value=%s\n&quot;</span></div>
<div class="line"><span class="lineno">   47</span>           <span class="stringliteral">&quot;disk_space,host=server01 value=%s\n&quot;</span></div>
<div class="line"><span class="lineno">   48</span>           <span class="stringliteral">&quot;ipv4,host=server01 value=\&quot;%s\&quot;\n&quot;</span></div>
<div class="line"><span class="lineno">   49</span>           <span class="stringliteral">&quot;hostname,host=server01 value=\&quot;%s\&quot;\n&quot;</span>,</div>
<div class="line"><span class="lineno">   50</span>           cpu_temp,</div>
<div class="line"><span class="lineno">   51</span>           disk_space,</div>
<div class="line"><span class="lineno">   52</span>           ipv4,</div>
<div class="line"><span class="lineno">   53</span>           <a class="code hl_variable" href="write_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>);</div>
<div class="line"><span class="lineno">   54</span>}</div>
<div class="ttc" id="awrite_8c_html_a423a478c44e2b1cb151313dba8750784"><div class="ttname"><a href="write_8c.html#a423a478c44e2b1cb151313dba8750784">get_system_data</a></div><div class="ttdeci">void get_system_data(char *cpu_temp, char *disk_space, char *ipv4)</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00027">write.c:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="write_8c.html#a423a478c44e2b1cb151313dba8750784">get_system_data()</a>, <a class="el" href="write_8c.html#af203df082d5c6dcaa0c88b07cf86466d">hostname</a>, and <a class="el" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="a423a478c44e2b1cb151313dba8750784" name="a423a478c44e2b1cb151313dba8750784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a423a478c44e2b1cb151313dba8750784">&#9670;&#160;</a></span>get_system_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_system_data </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>cpu_temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>disk_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ipv4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00027">27</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   27</span>                                                                   {</div>
<div class="line"><span class="lineno">   28</span>  <span class="comment">// Example of mocked data - you can replace this with actual system commands</span></div>
<div class="line"><span class="lineno">   29</span>  snprintf(cpu_temp, <a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>, <span class="stringliteral">&quot;72.5&quot;</span>); <span class="comment">// Mocked CPU temperature in Celsius</span></div>
<div class="line"><span class="lineno">   30</span>  snprintf(disk_space,</div>
<div class="line"><span class="lineno">   31</span>           <a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>,</div>
<div class="line"><span class="lineno">   32</span>           <span class="stringliteral">&quot;50&quot;</span>); <span class="comment">// Mocked disk space usage percentage</span></div>
<div class="line"><span class="lineno">   33</span>  snprintf(ipv4, <a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>, <span class="stringliteral">&quot;192.168.1.100&quot;</span>); <span class="comment">// Mocked IPv4 address</span></div>
<div class="line"><span class="lineno">   34</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#a80aad395c45035ccaceebbd08ecd100d">build_payload()</a>.</p>

</div>
</div>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00056">56</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>           {</div>
<div class="line"><span class="lineno">   57</span>  CURL *curl;</div>
<div class="line"><span class="lineno">   58</span>  CURLcode res;</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  <span class="comment">// InfluxDB HTTP URL</span></div>
<div class="line"><span class="lineno">   61</span>  <span class="keywordtype">char</span> url[<a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_function" href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url</a>(url);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <span class="comment">// Data to send</span></div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordtype">char</span> payload[<a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_function" href="write_8c.html#a80aad395c45035ccaceebbd08ecd100d">build_payload</a>(payload);</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>  <span class="comment">// Initialize libcurl</span></div>
<div class="line"><span class="lineno">   69</span>  curl_global_init(CURL_GLOBAL_DEFAULT);</div>
<div class="line"><span class="lineno">   70</span>  curl = curl_easy_init();</div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">if</span> (curl) {</div>
<div class="line"><span class="lineno">   72</span>    <span class="comment">// Set options for the POST request</span></div>
<div class="line"><span class="lineno">   73</span>    curl_easy_setopt(curl, CURLOPT_URL, url);</div>
<div class="line"><span class="lineno">   74</span>    curl_easy_setopt(curl, CURLOPT_POST, 1L);</div>
<div class="line"><span class="lineno">   75</span>    curl_easy_setopt(curl, CURLOPT_POSTFIELDS, payload);</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <span class="comment">// Set the Authorization header with the API token</span></div>
<div class="line"><span class="lineno">   78</span>    <span class="keyword">struct </span>curl_slist *headers = NULL;</div>
<div class="line"><span class="lineno">   79</span>    headers = curl_slist_append(headers, <span class="stringliteral">&quot;Content-Type: text/plain&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordtype">char</span> auth_header[<a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>];</div>
<div class="line"><span class="lineno">   81</span>    snprintf(auth_header, <a class="code hl_define" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>, <span class="stringliteral">&quot;Authorization: Token %s&quot;</span>, <a class="code hl_variable" href="write_8c.html#a1d71425d9df28667d528833a4db10432">token</a>);</div>
<div class="line"><span class="lineno">   82</span>    headers = curl_slist_append(headers, auth_header);</div>
<div class="line"><span class="lineno">   83</span>    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="comment">// Perform the request</span></div>
<div class="line"><span class="lineno">   86</span>    res = curl_easy_perform(curl);</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <span class="comment">// Check for errors</span></div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">if</span> (res != CURLE_OK) {</div>
<div class="line"><span class="lineno">   90</span>      fprintf(stderr,</div>
<div class="line"><span class="lineno">   91</span>              <span class="stringliteral">&quot;curl_easy_perform() failed: %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">   92</span>              curl_easy_strerror(res));</div>
<div class="line"><span class="lineno">   93</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   94</span>      printf(<span class="stringliteral">&quot;Data written successfully to InfluxDB\n&quot;</span>);</div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="comment">// Clean up</span></div>
<div class="line"><span class="lineno">   98</span>    curl_slist_free_all(headers); <span class="comment">// Free headers</span></div>
<div class="line"><span class="lineno">   99</span>    curl_easy_cleanup(curl);</div>
<div class="line"><span class="lineno">  100</span>  }</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  <span class="comment">// Clean up global libcurl resources</span></div>
<div class="line"><span class="lineno">  103</span>  curl_global_cleanup();</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  106</span>}</div>
<div class="ttc" id="awrite_8c_html_a1d71425d9df28667d528833a4db10432"><div class="ttname"><a href="write_8c.html#a1d71425d9df28667d528833a4db10432">token</a></div><div class="ttdeci">char * token</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00013">write.c:13</a></div></div>
<div class="ttc" id="awrite_8c_html_a80aad395c45035ccaceebbd08ecd100d"><div class="ttname"><a href="write_8c.html#a80aad395c45035ccaceebbd08ecd100d">build_payload</a></div><div class="ttdeci">void build_payload(char *payload)</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00037">write.c:37</a></div></div>
<div class="ttc" id="awrite_8c_html_a9fd3406cc9e17f33dec6c2f39bb2aaed"><div class="ttname"><a href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url</a></div><div class="ttdeci">void build_influxdb_url(char *url)</div><div class="ttdef"><b>Definition</b> <a href="write_8c_source.html#l00017">write.c:17</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url()</a>, <a class="el" href="write_8c.html#a80aad395c45035ccaceebbd08ecd100d">build_payload()</a>, <a class="el" href="write_8c.html#a7244ab798f58214294b580ca0bb48552">MAX_BUF_SIZE</a>, and <a class="el" href="write_8c.html#a1d71425d9df28667d528833a4db10432">token</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8a48a6504d4d5a43bd3ab452ee0e8cb4" name="a8a48a6504d4d5a43bd3ab452ee0e8cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a48a6504d4d5a43bd3ab452ee0e8cb4">&#9670;&#160;</a></span>database</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* database = &quot;test_bucket1&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00012">12</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url()</a>.</p>

</div>
</div>
<a id="af203df082d5c6dcaa0c88b07cf86466d" name="af203df082d5c6dcaa0c88b07cf86466d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af203df082d5c6dcaa0c88b07cf86466d">&#9670;&#160;</a></span>hostname</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hostname = &quot;192.168.86.53&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00010">10</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url()</a>, and <a class="el" href="write_8c.html#a80aad395c45035ccaceebbd08ecd100d">build_payload()</a>.</p>

</div>
</div>
<a id="a83a04ad582de2b7d36b96f9db429c2c6" name="a83a04ad582de2b7d36b96f9db429c2c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a04ad582de2b7d36b96f9db429c2c6">&#9670;&#160;</a></span>port</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t port = 8086</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00011">11</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#a9fd3406cc9e17f33dec6c2f39bb2aaed">build_influxdb_url()</a>.</p>

</div>
</div>
<a id="a1d71425d9df28667d528833a4db10432" name="a1d71425d9df28667d528833a4db10432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d71425d9df28667d528833a4db10432">&#9670;&#160;</a></span>token</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* token</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="stringliteral">&quot;rtGd3JEQgWFW5rEgCKyNLYIlQCoSu-&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;H8bMYE3ejQHI3I2tUbkNIZySWDZVfEuGanvH1ttow9ZBpLbi6EPKquFw==&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="write_8c_source.html#l00013">13</a> of file <a class="el" href="write_8c_source.html">write.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="write_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
